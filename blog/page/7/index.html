
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>大头龙仔Blog</title>
  <meta name="author" content="imlcl">

  
  <meta name="description" content="function fwrite_stream($fp, $string)
{ $strLen  = strlen($string); for ( $written = 0; $written < $strLen; $written += $len ) { $len = fwrite($fp, &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://imlcl.com/blog/page/7">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="大头龙仔Blog" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">大头龙仔Blog</a></h1>
  
    <h2>A strong man can save himself. A great man can save another.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com.au/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:imlcl.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/02/05/c_php_fwrite/">惯C使用PHP的fwrite</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-02-05T00:00:00+08:00" pubdate data-updated="true">2010-02-05</time>
        
      </p>
    
  </header>


  <div class="entry-content"><pre lang="php">
function fwrite_stream($fp, $string)
{
    $strLen  = strlen($string);
    for ( $written = 0; $written < $strLen; $written += $len )
    {
        $len = fwrite($fp, substr($string, $written));
        if ( ! $len )
        {
            return $len;
        }
    }
    return $written;
}
</pre>
我们可能有时需要popen一个程序，通过管理传送数据给此程序
这时我们用fwrite来写入，事实上此时写入最大长度为4096，从strace跟踪就可以得知
所以我们一次fwrite写不完，就需要一次次地去写，上面的fwrite_stream是PHP Manual提供的，当遇到此种情况时可以用
其实就是惯C用法了，不过我平时总是因为PHP是脚本语言而忽略一些细节，平时也没有遇到要写这么大的数据量，这次遇到问题总结一下

事实上写文件时也可以用这个函数，不过PHP好像比较推荐用file_put_contents来写入一大坨数据
同样想一次读入整个文件内容，用file_get_contents也是比较好的，因为
<pre>file_get_contents() is the preferred way to read the contents of a file into a string.
It will use memory mapping techniques if supported by your OS to enhance performance.﻿</pre>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/02/04/tip_about_linux_find/">关于find技巧一则</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-02-04T00:00:00+08:00" pubdate data-updated="true">2010-02-04</time>
        
      </p>
    
  </header>


  <div class="entry-content">今天改一个bug的时候，遇到一个问题卡住了，想了很久，最后用比较简洁的方法解决了

之后做数据中心，需要删除一些临时文件的，这些临时文件只能是生成1分钟后才能删除
当时解决方法是递归这个目录，并用mtime来判断时间，再删之

这次遇到的问题是在linux下的，很自然会想用shell命令行来代替PHP解决之了，先把解决方解贴出来
<pre lang="bash">find /tmp/ -name "*.php_tmp" -maxdepth 1 -mmin +5 | xargs rm -f
</pre>
这就把过去5分钟或更久的、文件名后缀为.php_tmp的、是/tmp/当前目录的文件强制删除了
之后用PHP调用popen就完事啦，看来挺简洁的

其实还可以
<pre lang="bash">find /tmp/ -name "*.php_tmp" -maxdepth 1 -mmin +5 -exec rm -f {} +
# 或
find /tmp/ -name "*.php_tmp" -maxdepth 1 -mmin +5 -exec rm -f {} \;
</pre>
我是建议使用-exec来执行，不建议多一个管道来调用xargs，不过该环境好像只能用xargs……
如果想用小时，就可以用-mtime +5，就是5小时了
其实-maxdepth是很重要的，1表示只搜索当前目录，这样大大挺高搜索效率，因为find默认是递归所有子目录的

写于此，备忘
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/02/03/see_scgi/">小识SCGI</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-02-03T00:00:00+08:00" pubdate data-updated="true">2010-02-03</time>
        
      </p>
    
  </header>


  <div class="entry-content">今天slackpkg升级slackware时，发现httpd.conf.new多了一行：
<strong>LoadModule proxy_scgi_module lib/httpd/modules/mod_proxy_scgi.so</strong>

然后就上网查了一下scgi了，<a href="http://www.python.ca/scgi/" target="_blank">这里</a>有比较详细的介绍，包括搭方式
目前来说，从google得知，这东东实现是fastcgi简单，作为CGI的替代，SCGI全称Simple Common Gateway Interface
看了一下SCGI简短的<a href="http://www.python.ca/scgi/protocol.txt" target="_blank">协议说明</a>，注意到它有个特点是在WEB服务器应答的HTTP头需要强制返回CONTENT_LENGTH字段
就我所知，这个字段在我用过的服务器上可有可无，当时毕业设计写的WEB服务器，返回浏览器时也可以不包括这个字段
用PHP模拟应答时也可以不包括内容长度，但有的话就更适合HTTP协议了。而SCGI在这里说内容长度是must have的

PS：slackware-current最近内核升级跟得很快呢
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/02/03/hiphop_for_php/">HipHop for PHP</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-02-03T00:00:00+08:00" pubdate data-updated="true">2010-02-03</time>
        
      </p>
    
  </header>


  <div class="entry-content">听到HipHop实在太熟悉了，不过这次想不到是一个开源项目的名称

之前听说<a href="http://blog.geekliu.com/2010/02/01/compile_php.html" target="_blank">Facebook将重写PHP运行时机制</a>，现在才知道这项目开展了有一段时间了（<a href="http://news.csdn.net/a/20100203/216872.html" target="_blank">Facebook性能大提升的秘密：HipHop</a>）

上网搜了一下，发现链接暂时都不能访问，因为GFW封了facebook的域名，只能翻墙或者再等等看了
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/02/01/compile_php/">Facebook将重写PHP运行时机制</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-02-01T00:00:00+08:00" pubdate data-updated="true">2010-02-01</time>
        
      </p>
    
  </header>


  <div class="entry-content">详见<a href="http://developers.slashdot.org/story/10/01/31/0252201/Facebook-Rewrites-PHP-Runtime-For-Speed" target="_blank">http://developers.slashdot.org/story/10/01/31/0252201/Facebook-Rewrites-PHP-Runtime-For-Speed</a>

虽然不确定，但这个举动非常值得期待，让PHP也像Python那样可以编译
10倍的性能提升将非常可观，为关键的应用程序带来高性能的支持
耐心等待这个东东的出世
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/01/27/about_my_audio_card/">可恶的声卡</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-01-27T00:00:00+08:00" pubdate data-updated="true">2010-01-27</time>
        
      </p>
    
  </header>


  <div class="entry-content">关于我的声卡，说来，话好像挺长的

在我读初三的时候，开始喜欢上高品质的音乐，可能一方面是受到老爸的影响吧
好像当时自己花了350元积蓄，我想想，当时还借了朋友100元，才买了一张创新SB Live 5.1声卡，那个时代的声卡之王是创新

然后这张显卡从我初三开始，伴随我PC主机的更新，一直用到2008年底，这样一算有七八年之久了
其它这卡还能用，不过应该是老化所致，电流声已经比较明显
当初还没有换的念头，直至我换了4G内存的PC主机，发现这个卡子会莫名其妙的爆音，上网一查是这卡在32BIT操作系统下，最多只能正常运作于2G内存环境下
之后我升64BIT，其它还好，但发现64BIT的创新驱动没跟上，心情很不爽，用着这卡配HIVI 1080真是有点可惜……
后来把这卡拆了下来，换个集成声卡ALC888，发现音质怎么好了这么多
其它集成声卡进步如此的快，我也不知道，听说ACL888还是民用集成声卡的高档货（当时）

后来一波三折买了乐之邦<a href="http://www.musiland.com.cn/index.php/Product/show/id/126" target="_blank">X-Sword II Pro-HD</a>声卡回来（最开始我挑的是2496，不过那张卡坏了，后来没货了，可惜），这东西当时花我了800大洋，心痛啊……
不过这个卡还是很正点，回来一装驱动，弄了首普通的歌一听，比之前听到的细节都多。其实我的耳杂是很不专业的，但我觉得这卡加1080听人声非常合适，这也是我听得最多的音乐

不过后来有一天，发现这个卡突然用不了，最近发现是PCI那里松了
这个问题往后还发生多次，最近又发生了一次，超级不爽，是不是国产的做工就会比较差呢？希望不是吧
乐之邦还有一个不好就是没有Linux驱动，虽然这卡是ENVY24的芯片，理论上Linux有其驱动的。但乐之邦刷了他们定制过的BIOS，所以官方驱动是装不上的，所以Linux下就没有声音了……
而且这个卡不像以后型号，可以刷声卡BIOS以支持公版驱动。我也问过他们的技术人员，他们回答是暂不提供……

Anyway，这卡以后别出太多问题就可以了，现在用了还不到一年呢……
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/01/26/mit_sikuli_release/">MIT推出面向大众的图形脚本语言Sikuli</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-01-26T00:00:00+08:00" pubdate data-updated="true">2010-01-26</time>
        
      </p>
    
  </header>


  <div class="entry-content">今天看到<a href="http://blog.vgod.tw" target="_blank">vgod</a>的<a href="http://blog.vgod.tw/2010/01/25/change-the-world/" target="_blank">Change The World</a>，才发现他是<a href="http://groups.csail.mit.edu/uid/sikuli/" target="_blank">Sikuli</a>的发明人之一，关于Sikuli可以看这样一个<a href="http://v.youku.com/v_show/id_XMTQ3NjQ0OTQ0.html" target="_blank">视频</a>

我喜欢用<a href="http://www.autoitscript.com/" target="_blank">AutoIt</a>做一些简单的自动化，看到Sikuli就像看到一个更加易用的AutoIt（我暂时只想到这个比喻）

不过vgod那篇文章，我最喜欢就是他结尾那一段：

<span style="color: #003366;">我一直夢想著要做些不一樣的事情來改變世界，徹底發揮我的長處做出能夠對世界產生巨大影響力的東西。還記得三年前我在申請MIT時，在SOP上大膽的寫了 我的目標「I believe that programming environments should be smarter and more  intuitive, and it is my goal to reinvent one that allows beginners to  learn easily and adepts to be more  productive.」，而三年後的今天，我非常興奮我踏出了改變世界的第一步。</span>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/01/22/post_rss_addr/">文章RSS地址更改</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-01-22T00:00:00+08:00" pubdate data-updated="true">2010-01-22</time>
        
      </p>
    
  </header>


  <div class="entry-content">Blog文章RSS订阅地址改为：<a href="http://feeds.feedburner.com/geekliu" target="_blank">http://feeds.feedburner.com/geekliu</a>

才醒起，Google是收购了FeedBurner了
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/01/21/hostmonster_feeling/">Hostmonster主机使用感受</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-01-21T00:00:00+08:00" pubdate data-updated="true">2010-01-21</time>
        
      </p>
    
  </header>


  <div class="entry-content">其实新主机空间投入使用还不到一个星期，所以感受可能是假像
但这不到一个星期里，我感到<a href="http://www.hostmonster.com/" target="_blank">hostmonster</a>（可能是外国主机）是非常强大的

以前的域名和空间是在西部数码申请的，第一次买空间和域名就在这里了，始于2008年2月4日
最近收到以前域名<a href="http://slackcode.cn/" target="_blank">slackcode.cn</a>要提交什么证明，一气之下全搬到国外去了……

不说事情经过了，新域名是在<a href="https://www.godaddy.com/" target="_blank">godaddy</a>买的，开始买了个<a href="http://lcls.me/" target="_blank">lcls.me</a>，后来考虑了很久，觉得还是很有必要申请个com域名的，于是又多申请了一个<a href="http://geekliu.com" target="_blank">geekliu.com</a>了
空间是hostmonster买的，开始时怕付钱麻烦，包括在godaddy买域名的时候，后来直接用信用卡了，还是很方便的
空间方面，先买了一年是$59.40，加了个静态IP是$29.85，买静态IP是因为听了<a href="http://heeroluo.net/" target="_blank">heeroluo.net</a>朋友说的，这样一方面可以保证别人被封时，自己不会被封，而别一方面是静态IP可以对主机开放更多的东西，如开放指定端口等等。还有是，买空间是送域名的，当时还不知道， 晕……

进去看了看主机的配置还是不错的，使用上基本无限制，就一个CPU占用率不能持续占用太高，不然会挂起一会儿，一般情况下，还是很足够的。流量无限、空间无限、邮箱等那些就不说了
系统使用内核2.6.28的64位Linux，内存算了算好像是32GB，硬盘看到是640GB
忘了说了，因为第一次用到可以开SSH的主机，觉得很新奇。上面的信息是进入shell后看的，不一定准，因为无root权限
像我这种喜欢用命令行的人来说，这是最爽不过的，安全什么的都比较方面，有SSH就有SFTP，传东西就更安全和便捷了
当时发现各方面都不错，立马装个wordpress玩起来，坚持上得心应心。cPanel的确好用，里面有个Simple Script，一键安装wordpress，还内建很多电子商务，论坛等安全程序，非常强大，我当时看到有点傻了眼呢，国内在这方面差距很大

玩了这么一阵子，基本都了解cPanel的使用，总之就是强大，这个要亲自体会过才知道。据我所知，国外多数主机都使用cPanel的
主机运行这几天，都是非常稳定，速度不错，ping值在200ms多一些，在hostmonster里还可以设定让PHP工作在FastCGI模式下，以提升性能
<a href="http://blog.geekliu.com/wp-content/uploads/2010/01/FastCGI_1.png"><img class="alignnone size-full wp-image-637" title="FastCGI_1" src="http://blog.geekliu.com/wp-content/uploads/2010/01/FastCGI_1.png" alt="" width="599" height="314" /></a>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2010/01/21/hostmonster_feeling/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/01/17/red-bull-bc-one-2009/">Red Bull BC One 2009</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-01-17T00:00:00+08:00" pubdate data-updated="true">2010-01-17</time>
        
      </p>
    
  </header>


  <div class="entry-content">这里是官方版的<a href="http://www.hiphopzg.com/pocle/index.php/special/view/32">超链接</a>

这是BBIN今晚突然说起的，然后我就GOOGLE到这里看，图质和声音都不错的呢
BBIN说看得有点澎湃了，我说我也是，不过已经没有当年那么激动啦

然后他说之前在韶关HIPHOP PARTY，主持人问HIPHOP四要素是什么，有人说中国HIP-HOP四大元素是“粥粉饭面”，其实真的很有道理。
当然了，HIPHOP四要素是：Circle, Spiral, Voice and Line
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/8/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/6/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2013/01/01/first/">写给2013，写给我，写给我们</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/09/13/git-gitignore/">Git和.gitignore</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/08/05/1/">服务器基于slackware的KVM布署详解</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/08/04/1/">所谓码农（摘自《码农》第1期）</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/05/06/1/">[转]ZIP,一个没落天才的故事</a>
      </li>
    
  </ul>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - imlcl -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
